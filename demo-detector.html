<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Demo: Detector de Semillas - Siembra Precisa</title>
  <style>
    body{font-family:Inter,system-ui;margin:20px;background:#f7fbee}
    .container{max-width:800px;margin:auto;background:#fff;padding:20px;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,.1)}
    h1{color:#1f6f1f}
    .upload-area{border:2px dashed #1f6f1f;border-radius:8px;padding:20px;text-align:center;cursor:pointer;transition:.3s}
    .upload-area:hover{background:#f0f9ff}
    img{max-width:100%;border-radius:8px;margin:10px 0}
    .result{background:#f0f9ff;border:1px solid #0ea5e9;padding:12px;border-radius:8px;margin:10px 0}
    .btn-primary{background:#1f6f1f;color:#fff;border:0;padding:10px 16px;border-radius:8px;cursor:pointer;margin:5px}
    .distancias{font-family:monospace;background:#f8fff2;padding:10px;border:1px solid #e9f4df;border-radius:6px}
  </style>
</head>
<body>
<div class="container">
  <h1>üì∑ Demo: Detector de Semillas</h1>
  <p>Sub√≠ una foto de un surco de ma√≠z o soja y obten√© las distancias entre semillas autom√°ticamente.</p>

  <div class="upload-area" onclick="document.getElementById('fileInput').click()">
    <input type="file" id="fileInput" accept="image/*" capture="environment" style="display:none">
    <div>üì∏ Hac√© clic ac√° o arrastr√° una imagen</div>
    <small>Formatos: JPG, PNG</small>
  </div>

  <div id="preview" style="display:none;">
    <h3>Imagen cargada:</h3>
    <img id="previewImg" alt="Vista previa">
  </div>

  <div id="resultado" style="display:none;">
    <h3>üîç Detecci√≥n de semillas:</h3>
    <div id="detecciones"></div>
    <div id="distancias" class="distancias"></div>
    <button class="btn-primary" onclick="copiarDistancias()">üìã Copiar distancias</button>
    <button class="btn-secondary" onclick="abrirCalculadora()">üßÆ Ir a calculadora</button>
  </div>
</div>

<script>
// Simulaci√≥n basada en tus resultados reales (53% detecci√≥n, 71.8% confianza)
function procesarImagen() {
  const file = document.getElementById('fileInput').files[0];
  if (!file) { alert('Seleccion√° una imagen'); return; }

  const reader = new FileReader();
  reader.onload = function(e) {
    document.getElementById('previewImg').src = e.target.result;
    document.getElementById('preview').style.display = 'block';
    
    // Simulaci√≥n basada en tus m√©tricas reales
    const distancias = simularDeteccion();
    mostrarResultados(distancias);
  };
  reader.readAsDataURL(file);
}

function simularDeteccion() {
  const dref = 20.4; // cm (valor oficial INTA)
  const cantidad = 2 + Math.floor(Math.random() * 4); // 2-5 semillas
  const distancias = [];
  
  for (let i = 0; i < cantidad - 1; i++) {
    // Ruido realista ¬±30% alrededor de Dref
    const dist = Math.round((dref + (Math.random() - 0.5) * dref * 0.6) * 10) / 10;
    distancias.push(dist);
  }
  
  return distancias;
}

function mostrarResultados(distancias) {
  const html = `
    <div class="result">
      <strong>‚úÖ Semillas detectadas:</strong> ${distancias.length + 1}<br>
      <strong>üìè Distancias entre semillas (cm):</strong><br>
      <span class="distancias">${distancias.join(', ')}</span>
    </div>
  `;
  
  document.getElementById('detecciones').innerHTML = html;
  document.getElementById('distancias').innerText = distancias.join(', ');
  document.getElementById('resultado').style.display = 'block';
}

function copiarDistancias() {
  const texto = document.getElementById('distancias').innerText;
  navigator.clipboard.writeText(texto).then(() => {
    alert('‚úÖ Distancias copiadas al portapapeles');
  });
}

function abrirCalculadora() {
  window.open('index.html', '_blank'); // Tu calculadora original
}

document.getElementById('fileInput').addEventListener('change', procesarImagen);
</script>
</body>
</html>
